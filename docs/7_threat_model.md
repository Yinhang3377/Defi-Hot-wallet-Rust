# 7 — Threat Model（威胁模型）

<a id="toc"></a>
目录
- [1. 资产与范围](#assets)
- [2. 架构与数据流](#dfd)
- [3. 信任边界](#trust)
- [4. 威胁分析（STRIDE）](#threats)
- [5. 缓解措施与残余风险](#mitigations)
- [6. 验证与演练](#validation)
- [7. 变更日志](#changelog)

---

<a id="assets"></a>
## 1. 资产与范围
- 私钥/种子、助记词与分片、会话密钥、交易授权、RPC 凭据、审计日志与备份、用户 PII（最小化）。
- 范围：本地客户端（Rust）、软 HSM、RPC 通道、备份介质（本地/云/分布式）。

[↑ 返回目录](#toc)

---

<a id="dfd"></a>
## 2. 架构与数据流（文本版）
- 用户界面 ⇄ 应用层 ⇄ 安全模块（KDF/加密/软HSM）⇄ 网络层（RPC/节点管理）⇄ 区块链节点
- 审计与监控旁路：应用层/安全模块 → 审计日志 → 存储/导出；指标 → Prometheus

[↑ 返回目录](#toc)

---

<a id="trust"></a>
## 3. 信任边界
- 可信：本地受控内存（zeroize）、软HSM/硬件HSM接口。
- 半可信：RPC 提供商（白名单 + TLS + 响应校验）。
- 不可信：外部 DApp/未知合约、公共网络、第三方存储节点。

[↑ 返回目录](#toc)

---

<a id="threats"></a>
## 4. 威胁分析（STRIDE 摘要）
- S（伪装）：钓鱼 UI / 假合约授权 → 合约白名单、签名前模拟与摘要展示。
- T（篡改）：恶意 RPC 返回、交易被改 → TLS/域分离、签名内容回显与哈希校验。
- R（否认）：操作不可追溯 → 结构化审计日志、时间戳与签名。
- I（信息泄露）：日志含助记词、内存残留 → 脱敏、zeroize、最小权限。
- D（拒绝服务）：节点切换/限流缺失 → 白名单+超时+限流+重试退避。
- E（权限提升）：多签/审批绕过 → RBAC + 门限签名 + 关键操作二次确认。
- 供应链：依赖漏洞/构建污染 → cargo audit/cargo-deny、SBOM、签名发布（可接入 Sigstore）。

[↑ 返回目录](#toc)

---

<a id="mitigations"></a>
## 5. 缓解措施与残余风险
- 密钥：Argon2 参数化、软HSM不可导出、零化窗口最小化；残余风险：主机被完全攻陷。
- 交易：签名前模拟、摘要回显、限额/白名单；残余风险：用户社会工程学攻击。
- 网络：RPC 白名单与健康检查、TLS 校验、响应一致性；残余风险：上游提供商被攻陷。
- 日志/备份：加密存储、访问审计、最小可见性；残余风险：人为误操作。
- 供应链：依赖扫描、SBOM、重现构建；残余风险：零日漏洞。

[↑ 返回目录](#toc)

---

<a id="validation"></a>
## 6. 验证与演练
- 每季度威胁库复盘；红队/渗透演练；关键路径 fuzz；恢复演练（分片/备份）。
- 验收：攻击剧本覆盖 ≥ 10 个核心场景；关键缓解均有自动化测试。

[↑ 返回目录](#toc)

---

<a id="changelog"></a>
## 7. 变更日志
- 2025-09-21：初稿。

[↑ 返回目录](#toc)